Forskning viser at søvn har en væsentlig indflydelse på ens tilstand, dette gælder i høj grad bipolare patienter \citep{CPSP:CPSP1164}.
Endvidere, har vi også hørt gentagne gange fra psykologer, psykiatere og patienter at det er et meget fremtrædent problem for personer der har enten uni- eller bipolar depression \citep[Kapitel 2, Sektion 3,4,5]{misc:faellesrapp}.

Det viser sig at en regelmæssig søvn-vågen cykel er særdeles vigtig for bipolare patienter.
Eksempelvis kan mangel på søvn medføre større risiko for at gå ind i en mani- eller depressions-periode \citep{CPSP:CPSP1164}.

Hvis man er i en maniperiode sover man væsentligt mindre end for den habituelle periode \citep{CPSP:CPSP1164}.
Modsat for depression vil man typisk sove væsentligt længere end for den habituelle periode, men vi har også hørt fra patienter at de også kan have problemer med at sove \citep[Kapitel 2, Sektion 5]{misc:faellesrapp}.

Grundet dette anses søvn for en vigtig indikator på om man begynder at befinde sig i en mani- eller depressions-periode og bør derfor undersøges nærmere til at determinere sådanne perioder.

Desuden har \citet{art:sleepCusMania} udført et eksperiment på en enkelt testperson der indikerede at søvn mangel kunne føre til maniperioder som så oftest blev efterfulgt af en depression når personen havde fået lidt søvn.
Der er dog et par problemer med denne kilde, det første værende at den kun bruger en enkelt test person så det kunne være det bare var et særtilfælde og ikke et generelt træk.
Det andet problem er at informationen er fra 1991, så den kunne godt være modbevist siden, men vi har ikke været i stand til at finde noget sådan.
Udover denne ene kilde der indikerer at søvnmangel kan føre til mani, så er der flere kilder \citep{Mullington2009294,art:sleeplossHeart} der indikerer at søvnmangel kan føre til hjerteproblemer.
Ud over dette er der også fundet indikationer på at søvnmangel svækker immunsystemet \citep{misc:sleepImmune}.

Da søvn er en meget vigtig faktor til estimering af sygdomme og livskvalitet er der lagt en stor mængde forskning i dette område.
Dette giver udslag i en lang række af søvn estimerings metoder, hvor nogle af de mest fremtrædende muligheder nævnes og vurderes.
For at have en ordentlig grundlag for at diskutere datakilder er de benyttede metrikker dog først beskrevet.

\subsection{Metrikker}
\input{indhold/soevn/metrikker}

\subsection{Metoder}
Med et fælles grundlag for dataindsamling metrikker følger hermed en beskrivelse af en række søvnestimeringsmetoder.

\subsubsection{Polysomnografi}
Den måske mest akkurate søvnestimerings metode er polysomnografi, der er en metode der kombinerer et elektroencefalogram med målinger af muskel spænding og øjenbevægelse \citep{misc:polysomnografi,misc:polysomnography}.
Dog kræver denne metode en større mængde af special udstyr og erfarne teknikere til at montere udstyret på en patient, hvilket gør denne metode upraktisk i en almen patients soveværelse.

\subsubsection{AktiGrafi}
Imidlertid findes der andre metoder der er nemmere at benytte.
Et eksempel på sådan en søvnestimerings metode er aktigrafi, der er akkurat selvom det kun benytter sig af accelerometre påmonteret ens arm.
En sådan teknik kan estimere metrikker såsom timer sovet, søvn virkningsgrad, og antal af søvnafbrydelser.
Kendte eksempler på sådanne apparater findes ved eksempelvis FitBit og JawBone \citep{misc:fitbitSleepTracking,misc:jawBoneSleepTracking}.
Prisen på disse kan svinge fra 500 kroner til 2000 kroner baseret på hvilket produkt man køber, og påkræver at armbåndet er påmonteret når man sover.

Kravet om at udstyr som FitBit og JawBone skal være monteret på ens arm finder vi ikke som en tilstrækkelig hæmning for at afvise brugen af sådan en teknik.
Af samme grund står muligheden åben for at bruge sådant udstyr i fremtiden, hvis man er interesseret i mere akkurat søvn estimering end efterfølgende nævnte estimerings metoder.
Derudover er platformen opbygget til at være yderst fleksibelt angående hvilke moduler kan benyttes, så skulle man i fremtiden ønske at udvikle et modul der virker med FitBit/JawBone er dette muligt, men udskydes på pågældende tidspunkt grundet ressourcemangel i form af arbejdstid og det fornødne udstyr tilrådigt.
Der findes lignende løsninger der kun benytter sig af ens smartphone, men hvor man pålægger patienten at placere sin smartphone under hovedpuden.
Men ligesom FitBit/JawBone løsningen kræver det at man overdrager ansvaret til patienten om at placere sin smartphone i sengen, ligesom med armbåndene skal monteres på ens arm.

\subsubsection{Søvn Dagbog}
Der findes en lang række spørgeskemaer, hvor patienten får ansvaret for at udfylde sådanne skemaer, hvor man på den måde kan følge en patients søvnrytme.
Sådanne metoder er ikke vores fokus emne, men er en mulighed med den fleksible platform der er udviklet, hvor en sådan dagbog er et modul.
Dog er det værd at tage med i betragtning, når man skal lære en ny model, hvilket \cite{Min:2014:TNT:2556288.2557220} angiver, hvor man bruger dagbogen som "ground truth" til at træne ens model.

Med ressourcerne for dette projekt er dette dog ikke valgt som primær fokus, da vi ønsker en metode der kan estimere søvn med mindst mulig bruger intervention, og hvor grundlaget for vurdering skal være ved hjælp af sensorer fremfor en subjektiv vurdering man alligevel har mulighed for i forvejen.
Idéen om en "objektiv dagbog" er dermed også i tankerne her, og er hvorfor denne løsning ikke undersøges nærmere end at det kan bruges for læringsperioder for vores modeller.

\subsubsection{Toss 'N' Turn}\label{sec:tossNturn}
Følgende fremgangsmåde er præsenteret i \citet{Min:2014:TNT:2556288.2557220}, og beskrivelsen bygger på forsknings resultaterne derfra.

For Toss 'N' Turn fremgangsmåden er tanken at man blot skal have sin smartphone i sit soveværelse for at den kan estimere ens søvnstarttidspunkt, vækketidspunkt og sovelængde.
Teknikken tager udgangspunkt i en række sensorkilder der er tilgængelig på smartphonen i forvejen.
Disse værende accelerometer, mikrofon(maksamplitude), lyssensor, proximitysensor, kørende processer, batteri stadie (opladning/ikke opladning), og skærmvisningstilstand.
Ud fra disse sensorkilder og en søvndagbog der foretages i minimum tre dage, til at lære en søvnestimeringsmodel, kan de opnå en præcision med søvnlængde Mean Error (ME) på under 1 time.
Derudover har deres forskning vist at den gennemsnitlige præcision for daglig søvn estimering er på 83.97 \%.
Hvilket gør det til en oplagt mulighed at arbejde med.
Deres algoritme fungere så ved at foretage en række feature udtrækninger, og så bruge teknikker såsom exponential moving average, Naive Bayes classifier og decision trees til at opnå den fornødne nøjagtighed.
Hvis vi antager at den procent nøjagtighed de har på 84 \% er for en patient der sover 8 timer, vil dette betyde at søvnen estimeres med +- 76 minutter, hvilket er ganske meget når vi skal bestemme om en person sover for meget eller for lidt.
76 minutter i den forkerte retning kan sagtens resultere i at en person der sover for lidt bliver vurderet til at sove tilstrækkeligt og vice versa

En ulempe ved denne teknik er at den kræver en oplæringsperiode på minimum 3 dage for at få en lovende præcision, men er antaget at være et acceptabelt kompromis, da estimeringen så ville kunne fungere relativt præcist efterfølgende.

Derudover er det en klar fordel ved denne teknik at man ikke behøver at placere sin smartphone i sengen, og kræver derfor minimal bruger intervention, da mange folk alligevel bruger deres smartphone som vækkeur \citep{misc:phoneAlarmClock}.

Det ville dog være bedre med en søvnestimeringsteknik der ikke nødvendigvis kræver en træningsperiode.

\subsubsection{Best Effort Sleep Model}\label{sec:BES}
Best Effort Sleep (BES) Model \citet{6563918} bruger en fremgangsmåde der udelukkende baseres på målbare data fra en smartphone til at estimere en brugers søvnlængde, meget lig Toss 'N' Turn's koncept.
Disse målbare datakilder anskaffes på en måde så brugeren ikke behøver ændre sin søvn adfærd, som det fx er tilfældet på andre tilsvarende løsninger som fx JawBone eller FitBit der kræver at en wearable benyttes mens man sover.
Det at ingen af datakilderne er i direkte kontakt med brugeren går dog ud over præcisionen, da der er op mod 40 minutters unøjagtighed i estimeringen af søvnlængde, hvilket for en person der sover 8 timer svarer til 92 \% nøjagtighed.
Om denne unøjagtighed er acceptabel skal vurderes ud fra hvad informationen skal bruges til og hvilke kriterier der er til data.
Ud over dette kan BES ikke bruges til at estimere kvaliteten af ens søvn.
Med kvaliteten menes hvor mange gange man har været vågen i løbet af natten, til dette kræves involvering af brugeren, enten af de bruger en wearable eller at de interagerer med systemet.

I vores tilfælde vil denne fremgangsmåde fungere godt som en backup solution til en af de brugerinvolverende fremgangsmåder, da det største problem ved disse er at de bliver ubrugelige hvis brugeren ikke bruger dem rigtigt.
I de tilfælde hvor BES og en bruger involverende løsning begge er tilstede, kan BES bruges til at validere data fra den brugerinvolverende løsning. 

I BES bruges der seks forskellige målinger til at estimere søvn.
Grunden til det store antal målinger er, at det er nødvendigt med flere forskellige input kilder, da ingen af dem er i direkte kontakt med brugeren og at de hver for sig ikke siger særlig meget men i kombination giver en udmærket estimering om brugeren sover.
Kilderne der bruges er meget tilsvarende dem der bruges i Toss 'N' Turn beskrevet i \cref{sec:tossNturn}, hvor der her bruges lys, lyd, bevægelse (accelerometer), skærmlås, batteri status og om den er slukket.
Målinger fra disse datakilder skal vægtes forskelligt, og ud fra eksperimenterne udført af \citet{6563918}, nåede de frem til følgende vægtninger der kan ses i \cref{tab:vaegtninger}.

\begin{table}[h]
\centering
\begin{tabular}{|c|c|}
\hline Datakilde & Koefficient\\
\hline Lys & 0.0415 \\ 
\hline Lås & 0.0512 \\ 
\hline Slukket & 0.0000 \\ 
\hline Opladning & 0.0469 \\ 
\hline Bevægelse & 0.5445 \\ 
\hline Lyd & 0.3484 \\ 
\hline 
\end{tabular}
\caption{De forskellige vægtninger for hver datakilde.}
\label{tab:vaegtninger}
\end{table}

Disse koefficienter kan bruges af os til at springe en eventuel lærings periode over, dog kan dette gå ud over præcisionen.
Hvis præcisionen er meget vigtig vil man have en lærings periode, hvor man får den objektive sandhed om søvnlængden ind, så man kan blive i stand til at finde de optimale koefficient værdier for hver kilde.
Endvidere vil analysen også bedre kunne tilpasses til individet, frem for at bruge koefficienterne i \cref{tab:vaegtninger} der vil gøre analysen mere general.
Hvis man vælger at bruge en lærings perioden, vil det give en analyse der er bedre tilpasset individet, frem for den generelle løsning det vil være at bruge de koefficienter præsenteret i tabellen ovenover.

Fordelen ved BES er at den ikke kræver nogen form for interaktion med brugeren, udover at ens smartphone skal ligger tæt på hvor man sover.
Derudover er en fordel også at denne model er klar til at blive taget i brug med det samme hvis vi vælger at holde os til de koefficienter der blev præsenteret ovenover.
En ulempe er dog hvis man ligger sin smartphone i stuen vil det ikke sige særlig meget omkring ens søvn.
Endvidere har BES en ulempe i forhold til fx wearables løsninger, hvilket at den har en relativ høj unøjagtighed hvilket er på $\pm$40 minutter. 
Dette er en del i forhold til andre fremgangsmåder, men der bliver man nødt til at vurdere om det er acceptabelt når man tager i betragtning at brugeren ikke skal ændre sin adfærd for at bruge det og at der, i modsætning til de fleste andre fremgangsmåder, ikke kommer til at være aftener hvor målingerne ikke kan bruges fordi brugeren fx glemte at fortælle systemet at han gik i seng.

\subsubsection{Statistisk Baseret Tilgang}\label{sec:statbased}
Den statisk baserede tilgang bliver præsenteret som en lille del af \citet{misc:statbased}.
Denne metode bygger på at telefonen ligger i patientens seng og er så ud fra de bevægelser der sker i stand til at bestemme om personen sover eller ej.
Metoden ser på målingerne i sæt af fire minutter, og bestemmer for hver periode om patienten sover eller ej.
Til at nå frem til dette ser metoden på intensiteten af bevægelser for hver måling og sammenligner dette med et beregnet tærskelværdi.
Tærskelværdien beregnes som median plus standard deviation delt med to.
Hvis en selv defineret procent af målingerne overstiger det beregnede tærskelværdi, vurderes patienten til at være vågen, ellers estimeres det at patienten sover.